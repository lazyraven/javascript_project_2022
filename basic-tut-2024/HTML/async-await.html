<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../Javascript//async-await.js"></script>
    <link rel="stylesheet" href="../CSS/style.css">
    <title>ASYNC/AWAIT</title>
</head>
<body>
    <main>
        <section>
            <h2>ASYNC/AWAIT</h2>
            <p class="output">To view the output, you need to access the console tab of your browser's developer tools. - right click inspect mode</p>

            <ul>
                <li>ASYNC/AWAIT makes it easier to write promises.
                    The Keyword 'async' before function make the function return a promise always,
                    And the keyword 'await' is used inside async funcion, which makes the program wait until the promise resolves.
                </li>
                 <pre class="language-javascript">
                    let fruits = ["Apple", "Banana", "Kiwi"];

                        const animateOne = (fruit, animate) => {
                        return new Promise((resolve, reject) => {
                            setTimeout(() => {
                            animate(fruit);
                            resolve(true);
                            }, 1000);
                        });
                        };

                        const animateAll = async (animate) => {
                        await animateOne(fruits[0], animate);
                        await animateOne(fruits[1], animate);
                        await animateOne(fruits[2], animate);
                        };

                        const animate = (fruit) => {
                        console.log("animating", fruit);
                        };
                        animateAll(animate);
                </pre>
            </ul>

            <div>
                <h3>In Deep Knowledge :</h3>
                <p> Real-life Example:</p>
                <pre class="language-javascript">
                    async function cookDinner() {
                    console.log("Start cooking...");
                    await waitForBoilingWater();  // Wait until water boils
                    console.log("Add pasta.");
                    await waitForCooking();       // Wait until pasta is cooked
                    console.log("Dinner is ready!");
                    }

                </pre>

                <p>Example 2 in code:</p>
                <pre class="language-javascript">
                    function getData() {
                        return new Promise((resolve) => {
                            setTimeout(() => {
                            resolve("Here is your data");
                            }, 2000); // waits 2 seconds
                        });
                        }

                        async function showData() {
                        console.log("Fetching data...");
                        const result = await getData(); // Wait for the promise to finish
                        console.log(result);            // Then log it
                        }
                        showData();
                </pre>

                <h3>Benefits of async/await:</h3>
                <ul>
                    <li>Easier to read and write.</li>
                    <li>Avoids messy .then() / .catch() chains.</li>
                    <li>Looks like normal code, but works with Promises under the hood.</li>
                </ul>

                <h3>Examples using fetch() or how to handle errors with try/catch in async functions.</h3>
                <pre>
                    async function getUser() {
                    console.log("Fetching user...");

                    const response = await fetch("https://jsonplaceholder.typicode.com/users/1");
                    const data = await response.json();

                    console.log(data);
                    }
                    getUser();
                </pre>

                <h3>✅ 1. Using fetch() with async/await</h3>
                <p>Example: Get data from an API</p>
                <pre class="language-javascript">
                    async function getUser() {
                    console.log("Fetching user...");

                    const response = await fetch("https://jsonplaceholder.typicode.com/users/1");
                    const data = await response.json();

                    console.log(data);
                    }

                    getUser();

                </pre>

                <ul>  Explanation:
                    <li>await response.json() waits until the data is converted to JSON. </li>
                       <li>fetch() returns a Promise.</li>
                       <li>await fetch(...) waits until the response comes.</li>
                        <li>Then we log the data.</li>
                </ul>

                <h3> 2. Handling Errors with try/catch</h3>
                <p>Example: With error handling</p>
                <pre class="language-javascript">
                 async function getUserSafe() {
                        try {
                            console.log("Fetching user...");

                            const response = await fetch("https://jsonplaceholder.typicode.com/users/1");

                            if (!response.ok) {
                            throw new Error("Network response was not ok");
                            }

                            const data = await response.json();
                            console.log(data);
                        } catch (error) {
                            console.log("Something went wrong:", error.message);
                        }
                        }

                        getUserSafe();

                </pre>

                <ul>
                    Why use try/catch?
                    <li>If the network fails or something goes wrong, your app won’t crash.</li>
                    <li>You can handle errors nicely and show user-friendly messages.</li>
                </ul>

                <div>
                    <strong>
                        <pre>
            async  = >  Makes a function return a Promise
            await  =>  Waits for a Promise to finish
            try/catch  =>  Handles errors in async functions
                        </pre>
                    </strong>
            
                </div>
            </div>
        </section>
    </main>
    
</body>
</html>